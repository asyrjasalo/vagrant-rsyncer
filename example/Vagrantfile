# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|
  config.vm.box = 'ubuntu/trusty64'

  # Disable checking updates for faster testing
  config.vm.box_check_update = false
  config.vbguest.auto_update = false  if Vagrant.has_plugin?("vagrant-vbguest")

  config.vm.network 'private_network', ip: '10.10.10.10'

  config.vm.synced_folder '.', '/vagrant', disabled: true

  config.vm.synced_folder "files", "/home/vagrant/files", type: 'rsync',
    rsync__args: [
      "--archive",
      "--delete",
      "--force"
    ],
    rsync__exclude: [
      "/excluded_file.txt",
      "/excluded_directory",
      "excluded_nested_file.txt",
      "excluded_nested_directory",
      "*.not"
    ],
    rsync__verbose: true

  config.ssh.username = 'vagrant'
  config.ssh.forward_agent = true


  ### Vagrant syncer specific options ###
  if Vagrant.has_plugin?("vagrant-syncer")
    # All the plugin settings are introduced here with their default values
    # The defaults are used if the plugin is installed and the settings are not explicitly overridden here

    # How often (in seconds) to read the change events from the listeners
    config.syncer.interval = 0.2

    # Whether or not to start watching changes after the machine is up, reloaded or resumed
    config.syncer.run_on_startup = false

    # Whether or not the plugin outputs the file system events from the Listener
    config.syncer.show_events = false

    # Optional SSH arguments passed to rsync.
    config.syncer.ssh_args = [
      '-o StrictHostKeyChecking=no',
      '-o IdentitiesOnly=true',
      '-o UserKnownHostsFile=/dev/null'
    ]
  end
end
