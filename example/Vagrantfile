# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|
  config.vm.box = 'ubuntu/trusty64'

  # Disable checking updates for faster start up.
  config.vm.box_check_update = false
  config.vbguest.auto_update = false  if Vagrant.has_plugin?("vagrant-vbguest")

  config.vm.network 'private_network', type: 'dhcp'

  config.vm.synced_folder '.', '/vagrant', disabled: true

  config.vm.synced_folder "files", "/home/vagrant/files", type: 'rsync',
    rsync__args: [
      "--archive",
      "--delete",
      "--force",
      "--numeric-ids"
    ],
    rsync__exclude: [
      "/excluded_file.txt",
      "/excluded_directory",
      "excluded_nested_file.txt",
      "excluded_nested_directory",
      "*.not",
      ".git"
    ],
    rsync__verbose: true

  config.ssh.username = 'vagrant'
  config.ssh.forward_agent = true


  ### Vagrant syncer specific settings are introduced below

  # How often, in seconds, to read file system events.
  # Default: 0.2. Minimum is 0.2.
  config.syncer.interval = 0.2

  # Whether or not to start rsync-auto after the machine is up, reloaded or
  # resumed.
  # Default: true
  config.syncer.run_on_startup = true

  # Whether or not to show the file system events.
  # Default: false
  config.syncer.show_events = false

  # Whether or not to force using Listen gem, on OS X and Linux distros as well.
  # Default: false
  config.syncer.force_listen_gem = false

  # Optional SSH arguments passed to rsync, e.g. to cut down CPU load.
  #
  # If config.syncer.ssh_args are not given, the defaults on all platforms are:
  #  -o StrictHostKeyChecking=no
  #  -o IdentitiesOnly=true
  #  -o UserKnownHostsFile=/dev/null
  #
  # On non-Windows OSes, the defaults also include these:
  #  -o ControlMaster=auto
  #  -o ControlPath=<path_in_temp>
  #  -o ControlPersist=10m
  #
  config.syncer.ssh_args = [
    '-o StrictHostKeyChecking=no',
    '-o IdentitiesOnly=true',
    '-o UserKnownHostsFile=/dev/null',
    '-c arcfour,blowfish-cbc',
    '-o Compression=no',
    '-x'
  ]
end
